# üß™ Breast Cancer Pipeline (Airflow ETL Project)

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞: –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ –≤—ã–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –≤ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –ø–æ–º–æ—â—å—é Apache Airflow –∏ Python. 

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

* [–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞](#—Ü–µ–ª—å-–ø—Ä–æ–µ–∫—Ç–∞)
* [–û–ø–∏—Å–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø–∞–π–ø–ª–∞–π–Ω–∞)
* [–û–ø–∏—Å–∞–Ω–∏–µ DAG](#–æ–ø–∏—Å–∞–Ω–∏–µ-dag)
* [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–ø–æ-–∑–∞–ø—É—Å–∫—É)
* [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º)
* [–ê–Ω–∞–ª–∏–∑ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏](#–∞–Ω–∞–ª–∏–∑-—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏)
* [–†–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#—Ä–∞–∑–≤–∏—Ç–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
* [–°–∫—Ä–∏–Ω—à–æ—Ç—ã](#—Å–∫—Ä–∏–Ω—à–æ—Ç—ã)

---

## üîç –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞

### ü§ñ ML-–∑–∞–¥–∞—á–∞

–ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ Breast Cancer Wisconsin Diagnostic: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –æ–ø—É—Ö–æ–ª–∏ (–ú - Malignant –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, B - Benign –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è) –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ —Å–≤—è–∑—å)

| –°–∫—Ä–∏–ø—Ç           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                            | –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ               | –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ             |
| ---------------- | ------------------------------------- | ---------------------------- | --------------------------- |
| load\_data.py    | –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞           | –ò—Å—Ö–æ–¥–Ω—ã–π CSV —Ñ–∞–π–ª            | –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π CSV –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ |
| clean\_data.py   | –û—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞               | –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π CSV              | –û—á–∏—â–µ–Ω–Ω—ã–π CSV               |
| train\_model.py  | –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ pipeline | –û—á–∏—â–µ–Ω–Ω—ã–π CSV                | –§–∞–π–ª –º–æ–¥–µ–ª–∏ (.pkl)          |
| calc\_metrics.py | –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ     | –û—á–∏—â–µ–Ω–Ω—ã–π CSV, –º–æ–¥–µ–ª—å (.pkl) | JSON —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏            |

### –°—Ö–µ–º–∞

```mermaid
graph LR
    A[load_data] --> B[clean_data]
    B --> C[train_model]
    C --> D[calc_metrics]
```


## üõ† –û–ø–∏—Å–∞–Ω–∏–µ DAG

* **–ù–∞–∑–≤–∞–Ω–∏–µ DAG:** `breast_cancer_pipeline`
* **–¢–∏–ø:** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (`schedule_interval=None`)
* **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí –æ—á–∏—Å—Ç–∫–∞ ‚Üí –æ–±—É—á–µ–Ω–∏–µ ‚Üí —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫

### –û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

* `PythonOperator` —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `run_script(script_name)` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–∞–∂–¥—ã–π –∏–∑ `.py` —Å–∫—Ä–∏–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ `subprocess`.
* –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ `logs/`.

---

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

1. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   source venv/bin/activate
   pip install -r requirements.txt
   ```
   
2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Airflow –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:**
    ```bash
    airflow db init
    airflow scheduler &
    airflow webserver
    ```

3. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Airflow** –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8080](http://localhost:8080)

4. **–í–∫–ª—é—á–∏—Ç–µ DAG `breast_cancer_pipeline` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
    *–∏–ª–∏ —Å –ø–æ–º–æ—â—å—é CLI:*
    ```bash
    airflow tasks test breast_cancer_pipeline load_data 2025-06-28
    ```

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–∞–ø–∫–µ `results/`:**

    * `model.pkl` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å

    * `metrics.json` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

---

## ‚òÅÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞ (–º–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫–∏) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ `results/`:

* `results/model.pkl` ‚Äî –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å.
* `results/metrics.json` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
airflow_project/
‚îú‚îÄ‚îÄ dags/
‚îú‚îÄ‚îÄ etl/
‚îú‚îÄ‚îÄ logs/
‚îî‚îÄ‚îÄ results/
    ‚îú‚îÄ‚îÄ model.pkl
    ‚îî‚îÄ‚îÄ metrics.json
```

---

## ‚ö†Ô∏è –ê–Ω–∞–ª–∏–∑ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–±–æ—è

| –≠—Ç–∞–ø              | –í–æ–∑–º–æ–∂–Ω—ã–µ —Å–±–æ–∏                                 | –û–±—Ä–∞–±–æ—Ç–∫–∞                            |
| ----------------- | ---------------------------------------------- | ------------------------------------ |
| `load_data.py`    | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ–∞–π–ª–∞, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π CSV             | –ò—Å–∫–ª—é—á–µ–Ω–∏–µ + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ             |
| `clean_data.py`   | Null-–∑–Ω–∞—á–µ–Ω–∏—è, –æ—à–∏–±–∫–∏ —Ç–∏–ø–æ–≤                    | –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ          |
| `train_model.py`  | –ú–æ–¥–µ–ª—å –Ω–µ –æ–±—É—á–∞–µ—Ç—Å—è, –æ—à–∏–±–∫–∞ sklearn            | –û–±–µ—Ä–Ω—É—Ç–æ –≤ `try/except`, –ª–æ–≥–≥–∏—Ä—É–µ—Ç—Å—è |
| `calc_metrics.py` | –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ | –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã        |

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–±–æ–µ–≤ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

* **Retries:** —É –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ —É–∫–∞–∑–∞–Ω `retries=1` –∏ `retry_delay=300` (—á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç).
* **–ò–∑–æ–ª—è—Ü–∏—è:** –∫–∞–∂–¥—ã–π —à–∞–≥ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π Python-—Å–∫—Ä–∏–ø—Ç (–º–æ–¥—É–ª—å).
* **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ.
* **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ —Ñ—Ä–µ–π–º—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.

–ü—Ä–∏–º–µ—Ä:

* –ü–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º ‚Üí –∑–∞–¥–∞—á–∞ –ø–∞–¥–∞–µ—Ç, –ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç.
* –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –º–æ–¥–µ–ª—å ‚Üí `train_model.py` –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –ø–∞–π–ø–ª–∞–π–Ω –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

---

## –†–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

* –ó–∞–º–µ–Ω–∏—Ç—å `subprocess` –Ω–∞ `PythonVirtualenvOperator`/`PythonOperator` —Å –∏–º–ø–æ—Ä—Ç–æ–º —Ñ—É–Ω–∫—Ü–∏–π.
* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ S3-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ MinIO.
* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å Great Expectations.
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º (–∑–∞–º–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏—Å–∫–∞ –Ω–∞ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ).
* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫.

---

## –°–∫—Ä–∏–Ω—à–æ—Ç—ã

![image](https://github.com/user-attachments/assets/4ea36dad-ccf8-4f85-8a14-297878153eaa)

![image](https://github.com/user-attachments/assets/1182c272-9aa9-42a0-8012-93b55475b6dd)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏
{
  "accuracy": 0.9649122807017544,
  "precision": 0.975,
  "recall": 0.9285714285714286,
  "f1_score": 0.9512195121951219
}

üìå –í—ã–≤–æ–¥: –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏ –≤—ã—Å–æ–∫–∏–µ, –æ–¥–Ω–∞–∫–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∞–∂–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å recall –º–æ–∂–Ω–æ –µ—â–µ —É–≤–µ–ª–∏—á–∏—Ç—å.
---

**–ê–≤—Ç–æ—Ä:** NatalieGo
**–ü—Ä–æ–µ–∫—Ç:** ETL –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–∞–∫–∞ –≥—Ä—É–¥–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Airflow

